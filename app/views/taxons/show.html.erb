<%= display_header title: page.title, breadcrumbs: [:taxons, page.taxon] do %>
  <% unless page.unpublished? %>
    <%= link_to I18n.t('views.taxons.edit'), edit_taxon_path(page.taxon_content_id), class: "btn btn-default"%>

    <%= link_to new_taxon_migration_path(source_content_id: page.taxon_content_id),
      class: 'btn btn-md btn-default' do %>
      <i class="glyphicon glyphicon-move"></i>
      <%= I18n.t('views.taxons.move_content') %>
    <% end %>

    <%= link_to taxonomy_path(page.taxon_content_id, format: :csv), class: "btn btn-default" do %>
      <i class="glyphicon glyphicon-download-alt"></i>
      <%= I18n.t('views.taxons.download_csv') %>
    <% end %>
  <% end %>
<% end %>

<div class='view-on-site'>
  <% if page.published? %>
    View on site: <%= link_to page.base_path, website_url(page.base_path) %>
  <% elsif page.draft? %>
    <%= link_to "View draft page", website_url(page.base_path, draft: true) %>
  <% end %>
</div>

<div class="well state-box">
  <div class="state">State: <%= page.publication_state_name %></div>
  <% if page.published? %>
    <%= link_to "Delete", taxon_confirm_delete_path(page.taxon_content_id), class: 'delete-link' %>
  <% elsif page.draft? %>
    <%= link_to taxon_confirm_publish_path(page.taxon_content_id), class: 'btn btn-md btn-default' do %>
      Publish
    <% end %>
  <% elsif page.unpublished? %>
    <%= link_to taxon_restore_path(page.taxon_content_id), class: 'btn btn-md btn-default' do %>
      Restore
    <% end %>
  <% end %>
</div>

<% unless page.unpublished? %>
  <h3><%= t('views.taxons.tree') %></h3>

  <%= render 'taxonomy_tree', taxonomy_tree: page.taxonomy_tree %>

  <h3><%= t('views.taxons.tagged_content') %></h3>

  <% if page.tagged.any? %>
    <%= render 'tagged_content', tagged: page.tagged %>
  <% else %>
    <p class="no-content no-content-bordered">No content tagged to this taxon</p>
  <% end %>
<% end %>
