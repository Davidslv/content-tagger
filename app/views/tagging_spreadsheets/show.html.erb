<%= display_header title: 'Preview import', breadcrumbs: [:tagging_spreadsheets, "Preview"] do %>
  <%= link_to "Create tags", tagging_spreadsheet_publish_tags_path(@tagging_spreadsheet), method: :post, class: "btn btn-md btn-default" %>
  <%= link_to "Refresh import", tagging_spreadsheet_refetch_path(@tagging_spreadsheet), method: :post, class: "btn btn-md btn-default" %>
<% end %>

<% if @tagging_spreadsheet.state == "errored" %>
  <p class="alert alert-danger">
    An error occured when attempting to read the spreadsheet:

    <%= @tagging_spreadsheet.error_message %>
  </p>
<% else %>
  <div class='view-on-site'>
    View: <%= link_to "inspect spreadsheet", @tagging_spreadsheet.url, target: "_blank" %>
  </div>

  <%= render partial: "import_preview", locals: { tag_mappings: @tag_mappings } %>
<% end %>
