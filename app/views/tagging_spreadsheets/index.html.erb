<%= display_header title: 'Tagging spreadsheets', breadcrumbs: ['Tag importer'] do %>
  <%= link_to 'Upload spreadsheet', new_tagging_spreadsheet_path, class: 'btn btn-lg btn-default' %>
<% end %>

<table class="table queries-list table-bordered" data-module="filterable-table">
  <thead>
    <tr>
      <th>State</th>
      <th>Google Sheet URL</th>
      <th>Description</th>
      <th>Date added</th>
      <th>Added by</th>
      <th></th>
      <th></th>
    </tr>
    <%= render partial: 'shared/table_filter' %>
  </thead>
  <tbody>
    <% tagging_spreadsheets.each do |spreadsheet| %>
      <tr>
        <td><%= state_label_for(label_type: spreadsheet.label_type,
                                title: spreadsheet.state_title) %></td>
        <td><%= link_to spreadsheet.url, spreadsheet.url %></td>
        <td>
          <%= spreadsheet.description %>

          <% if spreadsheet.errored? %>
            <hr />
            <span class="error-message">
              <ul>
                <li><%= spreadsheet.error_message %></li>
              </ul>
            </span>
          <% end %>
        </td>
        <td>
          <%= time_tag_for(spreadsheet.created_at) %>
        </td>
        <td><%= spreadsheet.added_by.name %></td>
        <td>
          <%= link_to "Preview", tagging_spreadsheet_path(spreadsheet) %>
        </td>
        <td>
          <%= link_to "Delete", tagging_spreadsheet_path(spreadsheet), method: :delete, class: "btn btn-danger btn-sm" %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>
