<div class="taxonomy-tree">
  <div class="taxon-parents">
    <% taxonomy_tree.immediate_parents.each do |parent_node| %>
      <div class="parent-expansion">
        <div class="taxon-level taxon-depth-1">
          <span class="taxon-level-title">
            <%= link_to parent_node.name, taxon_path(parent_node.content_id) %>
          </span>
        </div>
        <% parent_node.each do |parent_ancestor| %>
          <% next if parent_ancestor.node_depth == 1 %>
          <div class="taxon-level taxon-depth-<%= parent_ancestor.node_depth %>">
            <span class="taxon-level-title">
              <%= link_to parent_ancestor.name, taxon_path(parent_ancestor.content_id) %>
            </span>
          </div>
        <% end %>
      </div>
    <% end %>
  </div>

  <% parents_class = taxonomy_tree.immediate_parents.present? ? "taxon-focus--has-parents" : "" %>
  <% children_class = taxonomy_tree.immediate_children.present? ? "taxon-focus--has-children" : "" %>

  <div class="taxon-focus <%= parents_class %> <%= children_class %>">
    <div class="taxon-level taxon-depth-0">
       <span class="taxon-level-title">
         <%= taxonomy_tree.root_node.name %>
       </span>
    </div>
  </div>

  <div class="taxon-children">
    <% taxonomy_tree.immediate_children.each do |child_node| %>
      <div class="child-expansion">
        <div class="taxon-level taxon-depth-1">
          <span class="taxon-level-title">
            <%= link_to child_node.name, taxon_path(child_node.content_id) %>
          </span>
        </div>
        <% child_node.each do |child_successor| %>
          <% next if child_successor.node_depth == 1 %>
          <div class="taxon-level taxon-depth-<%= child_successor.node_depth %>">
            <span class="taxon-level-title">
              <%= link_to child_successor.name, taxon_path(child_successor.content_id) %>
            </span>
          </div>
        <% end %>
      </div>
    <% end %>
  </div>
</div>
